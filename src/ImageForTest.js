import React from 'react';
import persik from './img/persik.png';
import spotty from './img/spotty.png';
import luna from './img/luna.png';
import puppy from './img/puppy.png';
import doctor from './img/doctor.png';
import catFish from './img/catFish.png';
import hardKot from './img/hardKot.png';
import horse from './img/horse.png';
import iLame from './img/iLameRu.png';
import kurica from './img/kurica.png';
import spider from './img/spider.png';
import vanya from './img/vanya.png';
// import vsIcon from './img/VSicon.png'; (Стримеры)
import bratishkin from './img/BratishkinOff.png';
import cheatBanned from './img/CheatBanned.png';
import evelone from './img/Evelone.png';
import gnumme from './img/Gnumme.png';
import iLameRU from './img/iLameRu копия.png';
import itpedia from './img/ITPEDIA.png';
import jesusavgn from './img/JesusAVGN.png';
import karmikKoala from './img/KarmikKoala.png';
import kuplinovPlay from './img/kuplinovPLAY.png';
import maddyson from './img/Maddyson.png';
import navalny from './img/Navalny.png';
import olsior from './img/Olsior.png';
import papich from './img/papich.png';
import paver from './img/Russia Paver.png';
import snailkick from './img/SnailKick.png';
import vjLink from './img/VJLINK.png';
import archangel_hs from './img/archangel_hs.png';
import blackUFA from './img/BlackUFA.png';
import dreadzTV from './img/DreadzTV.png';
import buster from './img/buster.png';
import ceh9 from './img/ceh9.png';
import hardgamechannel from './img/hardgamechannel.png';
import irmanPlay from './img/IrmanPlay.png';
import juice from './img/Juice.png';
import just_ns from './img/just_ns.png';
import manyrin from './img/Manyrin.png';
import mokrivskyi from './img/mokrivskyi.png';
import silverName from './img/SilverName.png';
import stRoGo from './img/StRoGo.png';
import zeus from './img/Zeus.png';
import zLOYn from './img/ZLOYn.png';
import hvost from './img/ХВОСТ.png';
// (Игры)
import witcher from './img/image1.png';
import rdr2 from './img/image2.png';
import skyrim from './img/image3.png';
import godOfWar from './img/image4.png';
import theLastOfUs from './img/image5.png';
import discoElysium from './img/image6.png';
import residentEvil2 from './img/image7.png';
import farcry3 from './img/image8.png';
import darkSouls3 from './img/image9.png';
import xcom2 from './img/image10.png';
import gta5 from './img/image11.png';
import portal2 from './img/image12.png';
import massEffect3 from './img/image13.png';
import falloutNewVegas from './img/image14.png';
import dishonered2 from './img/image15.png';
import destiny2 from './img/image16.png';
import civilization5 from './img/image17.png';
import lifeIsStrange from './img/image18.png';
import outlast2 from './img/image19.png';
import detroit from './img/image20.png';
import doom from './img/image21.png';
import assassinsCreed from './img/image22.png';
import finalFantasy15 from './img/image23.png';
import theWalkingDead from './img/image24.png';
import metalGearSolid5 from './img/image25.png';
import hotlineMiami from './img/image26.png';
import batman from './img/image27.png';
import uncharted4 from './img/image28.png';
import deathStranding from './img/image29.png';
import bioshockInfinity from './img/image30.png';
import minecraft from './img/image31.png';
import horizon from './img/image32.png';


import Group from "@vkontakte/vkui/dist/components/Group/Group";
import Title from "@vkontakte/vkui/dist/components/Typography/Title/Title";

let persikIMG = new TestImage(persik, 'Персик');
let spottyIMG = new TestImage(spotty, 'Спотти');
let lunaIMG = new TestImage(luna, 'Луна');
let puppyIMG = new TestImage(puppy, 'Паппи');
let doctorIMG = new TestImage(doctor, 'Доктор');
let catFishIMG = new TestImage(catFish, 'КотоРыба');
let hardKotIMG = new TestImage(hardKot, 'ХардКот');
let horseIMG = new TestImage(horse, 'Конь');
let iLameIMG = new TestImage(iLame, 'Ламыч');
let kuricaIMG = new TestImage(kurica, 'Курица');
let spiderIMG = new TestImage(spider, 'Паук');
let vanyaIMG = new TestImage(vanya, 'Ваня');
// Стримеры
let Bratishkin = new TestImage(bratishkin, 'BratishkinOff');
let CheatBanned = new TestImage(cheatBanned, 'CheatBanned');
let Evelone = new TestImage(evelone, 'Evelone');
let Gnumme = new TestImage(gnumme, 'Gnumme');
let ILameRU = new TestImage(iLameRU, 'iLameRU');
let Itpedia = new TestImage(itpedia, 'Itpedia');
let JesusAVGN = new TestImage(jesusavgn, 'JesusAVGN');
let Karmik = new TestImage(karmikKoala, 'Karmik Koala');
let Kuplinov = new TestImage(kuplinovPlay, 'Kuplinov');
let Maddyson = new TestImage(maddyson, 'Maddyson');
let Navalny = new TestImage(navalny, 'Навальный');
let Olsior = new TestImage(olsior, 'Olsior');
let Papich = new TestImage(papich, 'Папич');
let Paver = new TestImage(paver, 'Russia Paver');
let Snailkick = new TestImage(snailkick, 'SnailKick');
let VjLink = new TestImage(vjLink, 'VJLink');
let Archangel_hs = new TestImage(archangel_hs, 'archangel_hs');
let BlackUFA = new TestImage(blackUFA, 'BlackUFA');
let DreadzTV = new TestImage(dreadzTV, 'DreadzTV');
let Buster = new TestImage(buster, 'buster');
let Ceh9 = new TestImage(ceh9, 'ceh9');
let Juice = new TestImage(juice, 'Juice');
let Hardgamechannel = new TestImage(hardgamechannel, 'hardgamechannel');
let IrmanPlay = new TestImage(irmanPlay, 'IrmanPlay');
let Just_ns = new TestImage(just_ns, 'just_ns');
let Manyrin = new TestImage(manyrin, 'Manyrin');
let Mokrivskyi = new TestImage(mokrivskyi, 'mokrivskyi');
let SilverName = new TestImage(silverName, 'SilverName');
let StRoGo = new TestImage(stRoGo, 'StRoGo');
let Zeus = new TestImage(zeus, 'Zeus');
let ZLOYn = new TestImage(zLOYn, 'ZLOYn');
let Hvost = new TestImage(hvost, 'ХВОСТ');
// игры
let Witcher = new TestImage(witcher, 'Witcher');
let RedDeadRedemption2 = new TestImage(rdr2, 'Red Dead Redemption 2');
let Skyrim = new TestImage(skyrim, 'Skyrim');
let GodOfWar = new TestImage(godOfWar, 'God of War');
let TheLastOfUs = new TestImage(theLastOfUs, 'The last of us');
let DiscoElysium = new TestImage(discoElysium, 'Disco elysium');
let ResidentEvil2 = new TestImage(residentEvil2, 'Resident evil 2');
let Farcry3 = new TestImage(farcry3, 'Far cry 3');
let DarkSouls3 = new TestImage(darkSouls3, 'Dark souls 3');
let Xcom2 = new TestImage(xcom2, 'XCOM 2');
let Gta5 = new TestImage(gta5, 'GTA 5');
let Portal2 = new TestImage(portal2, 'Portal 2');
let MassEffect3 = new TestImage(massEffect3, 'Mass effect 3');
let FalloutNewVegas = new TestImage(falloutNewVegas, 'Fallout New Vegas');
let Dishonered2 = new TestImage(dishonered2, 'Dishonered 2');
let Destiny2 = new TestImage(destiny2, 'Destiny 2');
let Civilization5 = new TestImage(civilization5, 'Civilization 5');
let LifeIsStrange = new TestImage(lifeIsStrange, 'Life is strange');
let Outlast2 = new TestImage(outlast2, 'Outlast 2');
let Detroit = new TestImage(detroit, 'Detroit become human');
let Doom = new TestImage(doom, 'Doom');
let AssassinsCreed = new TestImage(assassinsCreed, 'Assassins Creed');
let FinalFantasy15 = new TestImage(finalFantasy15, 'Final Fantasy XV');
let TheWalkingDead = new TestImage(theWalkingDead, 'The walking dead');
let MetalGearSolid5 = new TestImage(metalGearSolid5, 'Metal gear solid 5');
let HotlineMiami = new TestImage(hotlineMiami, 'Hotline Miami');
let Batman = new TestImage(batman, 'Batman Arkham city');
let Uncharted4 = new TestImage(uncharted4, 'Uncharted 4');
let DeathStranding = new TestImage(deathStranding, 'Death stranding');
let BioshockInfinity = new TestImage(bioshockInfinity, 'Bioshock infinity');
let Minecraft = new TestImage(minecraft, 'Minecraft');
let Horizon = new TestImage(horizon, 'Horizon zero dawn');


// Массивы с картинками (Число картинок должно быть равно степени двойки)
let imageArr1 = [Bratishkin, CheatBanned, Evelone, Gnumme, ILameRU, Itpedia, JesusAVGN, Karmik, Kuplinov,
    Maddyson, Navalny, Olsior, Papich, Paver, Snailkick, VjLink, Buster, DreadzTV, BlackUFA, Archangel_hs, Ceh9,
    Hardgamechannel, IrmanPlay, Juice, Just_ns, Manyrin, Mokrivskyi, SilverName, StRoGo, Zeus, ZLOYn, Hvost];
let imageArr2 = [persikIMG, spottyIMG, lunaIMG, puppyIMG, doctorIMG, catFishIMG, hardKotIMG, horseIMG];
let imageArr3 = [Witcher, RedDeadRedemption2, Skyrim, GodOfWar, TheLastOfUs, DiscoElysium, ResidentEvil2, Farcry3,
    DarkSouls3, Xcom2, Gta5, Portal2, MassEffect3, FalloutNewVegas, Dishonered2, Destiny2, Civilization5, LifeIsStrange,
    Outlast2, Detroit, Doom, AssassinsCreed, FinalFantasy15, TheWalkingDead, MetalGearSolid5, HotlineMiami, Batman,
    Uncharted4, DeathStranding, BioshockInfinity, Minecraft, Horizon];
let imageArr4 = [persikIMG, persikIMG];

//Массив со всеми массивами с картинками.
let images = [imageArr1.slice(), imageArr2.slice(), imageArr3.slice(), imageArr4.slice()];

//Рабочий массив
let imageArr = [persikIMG, persikIMG];

let roundNum = 1;

//Счётчик кол-ва итераций
let counter = 1;
//Кол-во удалённых элементов
let undefinedElements;
//мин кол-во использований
let minUsage = 0;

// рандомные номера картинок из массива
let num1 = getRandomInt(0, imageArr.length-1);
let num2 = getRandomInt(0, imageArr.length-1);

// Нужно, чтобы картинки были разными
while(num1 === num2){
    num2 = getRandomInt(0, imageArr.length-1);
}

//Функция для получения рандомного числа от 0 до max
function getRandomInt(min, max) {
    // получить случайное число от (min-0.5) до (max+0.5)
    let rand = min - 0.5 + Math.random() * (max - min + 1);
    return Math.round(rand);
}

console.log('UPPER CLASS STARTED');

//Класс для изображений
function TestImage(image, text){
        this.image = image; //Картинка
        this.text = text; //Подпись к картинке
        this.useNum = 0; //Сколько раз использовали
}

class ImageForTest extends React.Component {

    constructor(props) {
        roundNum = 1;
        images = [imageArr1.slice(), imageArr2.slice(), imageArr3.slice(), imageArr4.slice()];
        imageArr = images[global.tests.currentTest - 1];
        for(let i = 0; i < imageArr.length; i++){
            imageArr[i].useNum = 0;
        }
        undefinedElements = 0;
        num1 = getRandomInt(0, imageArr.length-1);
        num2 = getRandomInt(0, imageArr.length-1);
        while(num1 === num2){
            num2 = getRandomInt(0, imageArr.length-1);
        }
        super(props);
        console.log('CONSTRUCTOR STARTED');
        console.log(imageArr);
    }

    state = {
        image1: imageArr[num1].image, //верхняя картинка
        image2: imageArr[num2].image, //нижняя картинка
        text1: imageArr[num1].text, //название верхней картинки
        text2: imageArr[num2].text, //название нижней картинки
        css1: 'looser', //класс верхней картинки
        css2: 'looser', //Класс нижней картинки
        textCss1: 'looser', //Класс названия картинок
        textCss2: 'looser',//класс названия картинок
        text: null, //Текст победителя
        vsIconCSS: 'looser', //CSS картинки VS
        roundTitle: 'Раунд ' + roundNum.toString(), //Название раунда
        roundTitleCSS: 'roundTitle', //CSS к названию раунда
    }
    roundAnimationFunc = () => {
        this.setState({
            image1: imageArr[num1].image, //верхняя картинка
            image2: imageArr[num2].image, //нижняя картинка
            text1: imageArr[num1].text, //название верхней картинки
            text2: imageArr[num2].text, //название нижней картинки
            css1: 'TestImage', //класс верхней картинки
            css2: 'TestImage', //Класс нижней картинки
            textCss1: 'textForImage1',
            textCss2: 'textForImage2',//класс названия картинок
            text: null, //Текст победителя
            vsIconCSS: 'VSicon', //CSS картинки VS
            roundTitle: 'Раунд ' + roundNum.toString(), //Название раунда
            roundTitleCSS: 'looser',

        })
    }

    changeImg1Remastered = () => {
        undefinedElements = 0;
        delete imageArr[num2];
        //Находим кол-во удалённых элементов
        for(let i = 0; i < imageArr.length; i++){
            if(imageArr[i] === undefined){
                undefinedElements++;
            }
        }

        if(undefinedElements < imageArr.length-1){
            counter++;
            if(imageArr.length - undefinedElements === imageArr.length / 2){
                roundNum++;
                this.setState({
                    css1: 'looser', //класс верхней картинки
                    css2: 'looser', //Класс нижней картинки
                    textCss1: 'looser', //Класс названия картинок
                    textCss2: 'looser',//класс названия картинок
                    text: null, //Текст победителя
                    vsIconCSS: 'looser', //CSS картинки VS
                    roundTitle: 'Раунд ' + roundNum.toString(), //Название раунда
                    roundTitleCSS: 'roundTitle', //CSS к названию раунда
                });

            }else if(imageArr.length - undefinedElements === imageArr.length / 4){
                roundNum++;
                this.setState({
                    css1: 'looser', //класс верхней картинки
                    css2: 'looser', //Класс нижней картинки
                    textCss1: 'looser', //Класс названия картинок
                    textCss2: 'looser',//класс названия картинок
                    text: null, //Текст победителя
                    vsIconCSS: 'looser', //CSS картинки VS
                    roundTitle: 'Раунд ' + roundNum.toString(), //Название раунда
                    roundTitleCSS: 'roundTitle', //CSS к названию раунда
                });
            }else if(imageArr.length - undefinedElements > 0 && imageArr.length - undefinedElements === imageArr.length / 8){
                roundNum++;
                this.setState({
                    css1: 'looser', //класс верхней картинки
                    css2: 'looser', //Класс нижней картинки
                    textCss1: 'looser', //Класс названия картинок
                    textCss2: 'looser',//класс названия картинок
                    text: null, //Текст победителя
                    vsIconCSS: 'looser', //CSS картинки VS
                    roundTitle: 'Раунд ' + roundNum.toString(), //Название раунда
                    roundTitleCSS: 'roundTitle', //CSS к названию раунда
                });
            }else if(imageArr.length - undefinedElements > 0 && imageArr.length - undefinedElements === imageArr.length / 16){
                roundNum++;
                this.setState({
                    css1: 'looser', //класс верхней картинки
                    css2: 'looser', //Класс нижней картинки
                    textCss1: 'looser', //Класс названия картинок
                    textCss2: 'looser',//класс названия картинок
                    text: null, //Текст победителя
                    vsIconCSS: 'looser', //CSS картинки VS
                    roundTitle: 'Раунд ' + roundNum.toString(), //Название раунда
                    roundTitleCSS: 'roundTitle', //CSS к названию раунда
                });
            }
            imageArr[num1].useNum++;
            imageArr.sort();
            console.log(imageArr);
            minUsage = 100;
            //Находим минимальное кол-во использований
            for(let i = 0; i < imageArr.length-counter; i++){
                if(imageArr[i].useNum < minUsage){
                    minUsage = imageArr[i].useNum;
                }
            }
            console.log('MinUSAGE = ' + minUsage);

            num1 = getRandomInt(0, imageArr.length-counter);
            while(imageArr[num1].useNum !== minUsage){
                num1 = getRandomInt(0, imageArr.length-counter);
            }
            num2 = getRandomInt(0, imageArr.length-counter);
            while((imageArr[num2].useNum !== minUsage) || (num1 === num2)){
                num2 = getRandomInt(0, imageArr.length-counter);
            }

            this.setState({
                image1: imageArr[num1].image,
                image2: imageArr[num2].image,
                text1: imageArr[num1].text,
                text2: imageArr[num2].text,
            });

        }else{
            global.tests.winner1 = imageArr[num1].image;
            this.setState({
                image1: imageArr[num1].image,
                css2:  'looser',
                css1: 'winner',
                text: global.tests.currentTestName,
                textCss1: 'looser',
                textCss2: 'looser',
                vsIconCSS: 'looser',
            });
            counter = 1;
            images = [imageArr1.slice(), imageArr2.slice(), imageArr3.slice(), imageArr4.slice()];
        }
    }

    changeImg2Remastered = () => {

        undefinedElements = 0;
        delete imageArr[num1];
        //Находим кол-во удалённых элементов
        for(let i = 0; i < imageArr.length; i++){
            if(imageArr[i] === undefined){
                undefinedElements++;
            }
        }

        if(undefinedElements < imageArr.length-1){
            counter++;
            if(imageArr.length - undefinedElements === imageArr.length / 2){
                roundNum++;
                this.setState({
                    css1: 'looser', //класс верхней картинки
                    css2: 'looser', //Класс нижней картинки
                    textCss1: 'looser', //Класс названия картинок
                    textCss2: 'looser',//класс названия картинок
                    text: null, //Текст победителя
                    vsIconCSS: 'looser', //CSS картинки VS
                    roundTitle: 'Раунд ' + roundNum.toString(), //Название раунда
                    roundTitleCSS: 'roundTitle', //CSS к названию раунда
                });

            }else if(imageArr.length - undefinedElements === imageArr.length / 4){
                roundNum++;
                this.setState({
                    css1: 'looser', //класс верхней картинки
                    css2: 'looser', //Класс нижней картинки
                    textCss1: 'looser', //Класс названия картинок
                    textCss2: 'looser',//класс названия картинок
                    text: null, //Текст победителя
                    vsIconCSS: 'looser', //CSS картинки VS
                    roundTitle: 'Раунд ' + roundNum.toString(), //Название раунда
                    roundTitleCSS: 'roundTitle', //CSS к названию раунда
                });
            }else if(imageArr.length - undefinedElements > 0 && imageArr.length - undefinedElements === imageArr.length / 8){
                roundNum++;
                this.setState({
                    css1: 'looser', //класс верхней картинки
                    css2: 'looser', //Класс нижней картинки
                    textCss1: 'looser', //Класс названия картинок
                    textCss2: 'looser',//класс названия картинок
                    text: null, //Текст победителя
                    vsIconCSS: 'looser', //CSS картинки VS
                    roundTitle: 'Раунд ' + roundNum.toString(), //Название раунда
                    roundTitleCSS: 'roundTitle', //CSS к названию раунда
                });
            }else if(imageArr.length - undefinedElements > 0 && imageArr.length - undefinedElements === imageArr.length / 16){
                roundNum++;
                this.setState({
                    css1: 'looser', //класс верхней картинки
                    css2: 'looser', //Класс нижней картинки
                    textCss1: 'looser', //Класс названия картинок
                    textCss2: 'looser',//класс названия картинок
                    text: null, //Текст победителя
                    vsIconCSS: 'looser', //CSS картинки VS
                    roundTitle: 'Раунд ' + roundNum.toString(), //Название раунда
                    roundTitleCSS: 'roundTitle', //CSS к названию раунда
                });
            }
            imageArr[num2].useNum++;
            imageArr.sort();
            console.log(imageArr);
            minUsage = 100;
            //Находим минимальное кол-во использований
            for(let i = 0; i < imageArr.length-counter; i++){
                if(imageArr[i].useNum < minUsage){
                    minUsage = imageArr[i].useNum;
                }
            }
            console.log('MinUSAGE = ' + minUsage);

            num1 = getRandomInt(0, imageArr.length-counter);
            while(imageArr[num1].useNum !== minUsage){
                num1 = getRandomInt(0, imageArr.length-counter);
            }

            num2 = getRandomInt(0, imageArr.length-counter);
            while((imageArr[num2].useNum !== minUsage) || (num1 === num2)){
                num2 = getRandomInt(0, imageArr.length-counter);
            }
            console.log('NUMS для следующего:');
            console.log(num1 + ' ' + num2);

            this.setState({
                image1: imageArr[num1].image,
                image2: imageArr[num2].image,
                text1: imageArr[num1].text,
                text2: imageArr[num2].text,
            });

        }else{
            global.tests.winner1 = imageArr[num2].image;
            this.setState({
                image1: imageArr[num2].image,
                css2:  'looser',
                css1: 'winner',
                text: global.tests.currentTestName,
                textCss1: 'looser',
                textCss2: 'looser',
                vsIconCSS: 'looser',
            });
            counter = 1;
            images = [imageArr1.slice(), imageArr2.slice(), imageArr3.slice(), imageArr4.slice()];
        }
    }

    render() {
        return(
            <Group title="test" className={'cardGrid'}>
            <div className={'picDIV'}>
                <div className={"sign"}>
                    <span className='sign__word'>{this.state.text}</span>
                </div>
                <h1><span className={this.state.roundTitleCSS} onAnimationEnd={this.roundAnimationFunc}>{this.state.roundTitle}</span></h1>

            <img id={'image1'} className={this.state.css1} src={this.state.image1} alt="Loading error" onClick={this.changeImg1Remastered}/>
                <Title level="1" weight="bold" className={this.state.textCss1}>{this.state.text1}</Title>

                    {/*<img className={this.state.vsIconCSS} alt="loading error" src={vsIcon} />*/}
                <Title level="1" weight="bold" className={this.state.textCss2}>{this.state.text2}</Title>
            <img id={'image2'} className={this.state.css2} src={this.state.image2} alt="Loading error" onClick={this.changeImg2Remastered}/>

            </div>
            </Group>
        )
    }
}
export default ImageForTest;